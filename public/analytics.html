<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>使用统计 - TG-Image</title>
    <meta name="description" content="查看您的图床使用统计和分析数据">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/navigation.css">
    <link rel="stylesheet" href="./css/analytics.css">
    <link rel="icon" href="./images/favicon.ico" type="image/x-icon">
</head>
<body>
    <!-- 导航组件 -->
    <div id="navigationContainer"></div>
    
    <!-- 主内容区域 -->
    <div class="main-content">
        <div class="page-header">
            <div class="header-content">
                <h1 class="page-title">
                    <i class="title-icon">📊</i>
                    使用统计
                </h1>
                <p class="page-description">查看详细的使用数据和趋势分析</p>
            </div>
            <div class="header-actions">
                <button class="action-btn" id="refreshDataBtn">
                    <i>🔄</i>
                    <span>刷新数据</span>
                </button>
                <button class="action-btn secondary" id="exportReportBtn">
                    <i>📋</i>
                    <span>导出报告</span>
                </button>
            </div>
        </div>

        <!-- 时间范围选择器 -->
        <div class="time-range-selector">
            <div class="range-buttons">
                <button class="range-btn active" data-range="7">最近7天</button>
                <button class="range-btn" data-range="30">最近30天</button>
                <button class="range-btn" data-range="90">最近90天</button>
                <button class="range-btn" data-range="365">最近一年</button>
            </div>
            <div class="custom-range">
                <input type="date" id="startDate" class="date-input">
                <span>至</span>
                <input type="date" id="endDate" class="date-input">
                <button class="apply-range-btn" id="applyCustomRange">应用</button>
            </div>
        </div>

        <!-- 概览卡片 -->
        <div class="stats-overview">
            <div class="stat-card">
                <div class="stat-icon">🖼️</div>
                <div class="stat-content">
                    <div class="stat-value" id="totalImagesCount">0</div>
                    <div class="stat-label">总图片数</div>
                    <div class="stat-change positive" id="imagesChange">+0%</div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">👁️</div>
                <div class="stat-content">
                    <div class="stat-value" id="totalViewsCount">0</div>
                    <div class="stat-label">总浏览量</div>
                    <div class="stat-change positive" id="viewsChange">+0%</div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">💾</div>
                <div class="stat-content">
                    <div class="stat-value" id="storageUsedValue">0 MB</div>
                    <div class="stat-label">存储使用</div>
                    <div class="stat-change" id="storageChange">+0%</div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">⬇️</div>
                <div class="stat-content">
                    <div class="stat-value" id="downloadsCount">0</div>
                    <div class="stat-label">下载次数</div>
                    <div class="stat-change positive" id="downloadsChange">+0%</div>
                </div>
            </div>
        </div>

        <!-- 图表区域 -->
        <div class="charts-container">
            <!-- 上传趋势图 -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3>上传趋势</h3>
                    <div class="chart-actions">
                        <button class="chart-action-btn" data-chart="uploads" data-type="line">
                            <i>📈</i>
                        </button>
                        <button class="chart-action-btn active" data-chart="uploads" data-type="bar">
                            <i>📊</i>
                        </button>
                    </div>
                </div>
                <div class="chart-content">
                    <canvas id="uploadsChart" width="400" height="200"></canvas>
                </div>
            </div>

            <!-- 浏览量趋势图 -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3>浏览量趋势</h3>
                    <div class="chart-actions">
                        <button class="chart-action-btn active" data-chart="views" data-type="line">
                            <i>📈</i>
                        </button>
                        <button class="chart-action-btn" data-chart="views" data-type="area">
                            <i>🌊</i>
                        </button>
                    </div>
                </div>
                <div class="chart-content">
                    <canvas id="viewsChart" width="400" height="200"></canvas>
                </div>
            </div>

            <!-- 存储使用情况 -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3>存储使用情况</h3>
                    <div class="storage-legend">
                        <span class="legend-item">
                            <span class="legend-color used"></span>
                            已使用
                        </span>
                        <span class="legend-item">
                            <span class="legend-color available"></span>
                            可用
                        </span>
                    </div>
                </div>
                <div class="chart-content">
                    <div class="storage-chart">
                        <div class="storage-ring">
                            <svg width="200" height="200" viewBox="0 0 200 200">
                                <circle cx="100" cy="100" r="80" stroke="#e5e7eb" stroke-width="20" fill="none"/>
                                <circle cx="100" cy="100" r="80" stroke="#667eea" stroke-width="20" fill="none"
                                        stroke-dasharray="502.65" stroke-dashoffset="376.99" 
                                        stroke-linecap="round" transform="rotate(-90 100 100)" id="storageProgress"/>
                            </svg>
                            <div class="storage-center">
                                <div class="storage-percentage" id="storagePercentage">25%</div>
                                <div class="storage-label">已使用</div>
                            </div>
                        </div>
                        <div class="storage-details">
                            <div class="detail-item">
                                <span class="detail-label">已使用:</span>
                                <span class="detail-value" id="usedStorage">250 MB</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">总容量:</span>
                                <span class="detail-value" id="totalStorage">1 GB</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">剩余:</span>
                                <span class="detail-value" id="remainingStorage">750 MB</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 热门图片排行 -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3>热门图片排行</h3>
                    <div class="ranking-period">
                        <select id="rankingPeriod">
                            <option value="today">今日</option>
                            <option value="week" selected>本周</option>
                            <option value="month">本月</option>
                        </select>
                    </div>
                </div>
                <div class="chart-content">
                    <div class="ranking-list" id="popularImages">
                        <!-- 热门图片列表将通过JavaScript生成 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 详细分析 -->
        <div class="detailed-analytics">
            <div class="analytics-grid">
                <!-- 文件类型分布 -->
                <div class="analysis-card">
                    <h3>文件类型分布</h3>
                    <div class="file-types-chart">
                        <canvas id="fileTypesChart" width="300" height="300"></canvas>
                    </div>
                    <div class="file-types-legend" id="fileTypesLegend">
                        <!-- 图例将通过JavaScript生成 -->
                    </div>
                </div>

                <!-- 上传时间分布 -->
                <div class="analysis-card">
                    <h3>上传时间分布</h3>
                    <div class="time-distribution">
                        <canvas id="timeDistributionChart" width="400" height="200"></canvas>
                    </div>
                </div>

                <!-- 设备类型统计 -->
                <div class="analysis-card">
                    <h3>设备类型统计</h3>
                    <div class="device-stats">
                        <div class="device-item">
                            <div class="device-icon">🖥️</div>
                            <div class="device-info">
                                <div class="device-name">桌面端</div>
                                <div class="device-percentage" id="desktopPercentage">65%</div>
                            </div>
                            <div class="device-bar">
                                <div class="device-progress" style="width: 65%"></div>
                            </div>
                        </div>
                        <div class="device-item">
                            <div class="device-icon">📱</div>
                            <div class="device-info">
                                <div class="device-name">移动端</div>
                                <div class="device-percentage" id="mobilePercentage">30%</div>
                            </div>
                            <div class="device-bar">
                                <div class="device-progress" style="width: 30%"></div>
                            </div>
                        </div>
                        <div class="device-item">
                            <div class="device-icon">📱</div>
                            <div class="device-info">
                                <div class="device-name">平板端</div>
                                <div class="device-percentage" id="tabletPercentage">5%</div>
                            </div>
                            <div class="device-bar">
                                <div class="device-progress" style="width: 5%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 地理分布 -->
                <div class="analysis-card">
                    <h3>访问地理分布</h3>
                    <div class="geo-distribution">
                        <div class="geo-item">
                            <span class="geo-flag">🇨🇳</span>
                            <span class="geo-country">中国</span>
                            <span class="geo-percentage">78%</span>
                        </div>
                        <div class="geo-item">
                            <span class="geo-flag">🇺🇸</span>
                            <span class="geo-country">美国</span>
                            <span class="geo-percentage">12%</span>
                        </div>
                        <div class="geo-item">
                            <span class="geo-flag">🇯🇵</span>
                            <span class="geo-country">日本</span>
                            <span class="geo-percentage">5%</span>
                        </div>
                        <div class="geo-item">
                            <span class="geo-flag">🇰🇷</span>
                            <span class="geo-country">韩国</span>
                            <span class="geo-percentage">3%</span>
                        </div>
                        <div class="geo-item">
                            <span class="geo-flag">🌍</span>
                            <span class="geo-country">其他</span>
                            <span class="geo-percentage">2%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="./js/navigation.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="./js/analytics.js"></script>
    <script>
        // 加载导航组件
        fetch('./components/navigation.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('navigationContainer').innerHTML = html;
                // 重新初始化导航
                const navigation = new NavigationController();
                navigation.initTheme();
                window.navigationController = navigation;
            });
    </script>
</body>
</html> 